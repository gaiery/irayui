(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{524:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},525:function(t,e,i){var r=i(3),o=i(45),n=i(29),a=i(524),s=r("".replace),p="["+a+"]",c=RegExp("^"+p+p+"*"),l=RegExp(p+p+"*$"),d=function(t){return function(e){var i=n(o(e));return 1&t&&(i=s(i,c,"")),2&t&&(i=s(i,l,"")),i}};t.exports={start:d(1),end:d(2),trim:d(3)}},526:function(t,e,i){"use strict";var r=i(16),o=i(273),n=i(15),a=i(110),s=i(29),p=i(45),c=i(76),l=i(274),d=i(275);o("match",(function(t,e,i){return[function(e){var i=p(this),o=null==e?void 0:c(e,t);return o?r(o,e,i):new RegExp(e)[t](s(i))},function(t){var r=n(this),o=s(t),p=i(e,r,o);if(p.done)return p.value;if(!r.global)return d(r,o);var c=r.unicode;r.lastIndex=0;for(var h,u=[],g=0;null!==(h=d(r,o));){var m=s(h[0]);u[g]=m,""===m&&(r.lastIndex=l(o,a(r.lastIndex),c)),g++}return 0===g?null:u}]}))},527:function(t,e,i){"use strict";var r=i(14),o=i(1),n=i(3),a=i(268),s=i(47),p=i(12),c=i(269),l=i(74),d=i(111),h=i(270),u=i(4),g=i(75).f,m=i(55).f,f=i(19).f,C=i(528),v=i(525).trim,x=o.Number,w=x.prototype,E=o.TypeError,X=n("".slice),Y=n("".charCodeAt),b=function(t){var e=h(t,"number");return"bigint"==typeof e?e:H(e)},H=function(t){var e,i,r,o,n,a,s,p,c=h(t,"number");if(d(c))throw E("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=v(c),43===(e=Y(c,0))||45===e){if(88===(i=Y(c,2))||120===i)return NaN}else if(48===e){switch(Y(c,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+c}for(a=(n=X(c,2)).length,s=0;s<a;s++)if((p=Y(n,s))<48||p>o)return NaN;return parseInt(n,r)}return+c};if(a("Number",!x(" 0o1")||!x("0b1")||x("+0x1"))){for(var W,M=function(t){var e=arguments.length<1?0:x(b(t)),i=this;return l(w,i)&&u((function(){C(i)}))?c(Object(e),i,M):e},I=r?g(x):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),y=0;I.length>y;y++)p(x,W=I[y])&&!p(M,W)&&f(M,W,m(x,W));M.prototype=w,w.constructor=M,s(o,"Number",M)}},528:function(t,e,i){var r=i(3);t.exports=r(1..valueOf)},529:function(t,e,i){"use strict";var r=i(3),o=i(112).PROPER,n=i(47),a=i(15),s=i(74),p=i(29),c=i(4),l=i(271),d=RegExp.prototype,h=d.toString,u=r(l),g=c((function(){return"/a/b"!=h.call({source:"a",flags:"b"})})),m=o&&"toString"!=h.name;(g||m)&&n(RegExp.prototype,"toString",(function(){var t=a(this),e=p(t.source),i=t.flags;return"/"+e+"/"+p(void 0===i&&s(d,t)&&!("flags"in d)?u(t):i)}),{unsafe:!0})},553:function(t,e,i){},587:function(t,e,i){"use strict";var r=i(5),o=i(1),n=i(113),a=i(77),s=i(48),p=i(21),c=i(174),l=i(58),d=i(78)("splice"),h=o.TypeError,u=Math.max,g=Math.min;r({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var i,r,o,d,m,f,C=p(this),v=s(C),x=n(t,v),w=arguments.length;if(0===w?i=r=0:1===w?(i=0,r=v-x):(i=w-2,r=g(u(a(e),0),v-x)),v+i-r>9007199254740991)throw h("Maximum allowed length exceeded");for(o=c(C,r),d=0;d<r;d++)(m=x+d)in C&&l(o,d,C[m]);if(o.length=r,i<r){for(d=x;d<v-r;d++)f=d+i,(m=d+r)in C?C[f]=C[m]:delete C[f];for(d=v;d>v-r+i;d--)delete C[d-1]}else if(i>r)for(d=v-r;d>x;d--)f=d+i-1,(m=d+r-1)in C?C[f]=C[m]:delete C[f];for(d=0;d<i;d++)C[d+x]=arguments[d+2];return C.length=v-r+i,o}})},588:function(t,e,i){"use strict";i(553)},599:function(t,e,i){"use strict";i.r(e);i(527),i(46),i(109),i(526),i(587),i(9),i(529),i(171);var r={name:"m-image-shot",model:{prop:"list"},props:{url:{type:String,required:!0},disabled:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}},scale:{type:Number,default:100},padding:{type:Number,default:1}},data:function(){return{pointList:[{index:1,position:["left","top"]},{index:2,position:[null,"top"]},{index:3,position:["right","top"]},{index:4,position:["right",null]},{index:5,position:["right","bottom"]},{index:6,position:[null,"bottom"]},{index:7,position:["left","bottom"]},{index:8,position:["left",null]}],lineList:["left","top","right","bottom"],trueWidth:0,trueHeight:0,currentWidth:0,currentHeight:0,tempCrop:{},changePosition:[],cropClientX:0,cropClientY:0,data_disable:this.disabled,imgUrlNew:"",target:{cropW:0,cropH:0},data_list:this.data_list}},mounted:function(){this.initImage(this.url)},methods:{clickGeneratePicture:function(){var t=this.$refs.previewImg;t.width=500,t.height=450;var e=this.$refs.sourceImg,i=t.getContext("2d"),r=(500-this.target.cropW/(this.scale/100))/2,o=(500-this.target.cropH/(this.scale/100))/2;i.drawImage(e,this.target.cropX/(this.scale/100),this.target.cropY/(this.scale/100),this.target.cropW/(this.scale/100),this.target.cropH/(this.scale/100),r,o,this.target.cropW/(this.scale/100),this.target.cropH/(this.scale/100))},getTargetImgUrl:function(){var t=this.$refs.previewImg.toDataURL("image/png").replace(this.imgType("png"),"image/octet-stream");this.$emit("targetImgUrl",t)},download:function(){var t=this.$refs.previewImg.toDataURL("image/png").replace(this.imgType("png"),"image/octet-stream");this.saveFile(t,"图片.png")},imgType:function(t){return"image/"+t.toLowerCase().replace(/jpg/i,"jpeg").match(/png|jpeg|bmp|gif/)[0]},saveFile:function(t,e){var i=document.createElement("a");i.href=t,i.download=e;var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!1),i.dispatchEvent(r)},initImage:function(t){var e=this,i=new Image;i.onload=function(){e.currentWidth=i.width*e.scale/100,e.currentHeight=i.height*e.scale/100,e.trueWidth=i.width,e.trueHeight=i.height,e.$emit("img",{width:i.width,height:i.height})},i.src=t},startMove:function(t){if(!this.disabled){var e={id:this.guid(),cropW:0,cropH:0,cropX:t.offsetX,cropY:t.offsetY,oldCropW:0,oldCropH:0,oldCropX:t.offsetX,oldCropY:t.offsetY,canEdit:!0};this.tempCrop=e,this.data_list=[],this.data_list.push(e),this.cropClientX=t.clientX,this.cropClientY=t.clientY,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop)}},createCrop:function(t){var e=t.clientX,i=t.clientY,r=this.tempCrop,o=e-this.cropClientX,n=i-this.cropClientY;o>=0?(r.cropW=Math.min(this.currentWidth-r.oldCropX-2*this.padding,o),r.cropX=r.oldCropX):(r.cropW=Math.min(r.oldCropX-2*this.padding,Math.abs(o)),r.cropX=Math.max(r.oldCropX+o,this.padding)),n>=0?(r.cropH=Math.min(this.currentHeight-r.oldCropY-2*this.padding,n),r.cropY=r.oldCropY):(r.cropH=Math.min(r.oldCropY-2*this.padding,Math.abs(n)),r.cropY=Math.max(r.oldCropY+n,this.padding)),r.cropW>10&&r.cropH>10&&(r.temp=!1),this.target=r,this.clickGeneratePicture()},endCrop:function(){window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),this.tempCrop={},this.$emit("getTargetBox",this.target),this.getTargetImgUrl()},cropMove:function(t,e){!this.disabled&&e.canEdit&&(this.cropClientX=t.clientX,this.cropClientY=t.clientY,e.oldCropW=e.cropW,e.oldCropH=e.cropH,e.oldCropX=e.cropX,e.oldCropY=e.cropY,this.tempCrop=e,window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop))},moveCrop:function(t){t.preventDefault();var e=t.clientX,i=t.clientY,r=this.tempCrop,o=e-this.cropClientX,n=i-this.cropClientY;r.cropX=Math.min(Math.max(r.oldCropX+o,this.padding),this.currentWidth-r.cropW-2*this.padding),r.cropY=Math.min(Math.max(r.oldCropY+n,this.padding),this.currentHeight-r.cropH-2*this.padding),this.target=r,this.clickGeneratePicture()},leaveCrop:function(){console.log("截图移动结束"),window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),this.$emit("getTargetBox",this.target),this.getTargetImgUrl()},deleteCrop:function(t){console.log("删除框选"),this.disabled||this.data_list.splice(t,1)},changeCropSize:function(t,e,i){!this.disabled&&e.canEdit&&(window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),this.cropClientX=t.clientX,this.cropClientY=t.clientY,e.oldCropW=e.cropW,e.oldCropH=e.cropH,e.oldCropX=e.cropX,e.oldCropY=e.cropY,this.changePosition=i,this.tempCrop=e,this.target=e,this.clickGeneratePicture())},changeCropNow:function(t){t.preventDefault();var e=t.clientX,i=t.clientY,r=this.tempCrop,o=this.changePosition,n=e-this.cropClientX,a=i-this.cropClientY;o.indexOf("left")>-1?r.oldCropW-n>=0?(r.cropW=Math.min(r.oldCropW-n,r.oldCropX+r.oldCropW),r.cropX=Math.max(this.padding,r.oldCropX+n)):(r.cropW=Math.min(n-r.oldCropW,this.currentWidth-r.oldCropX-r.oldCropW-2*this.padding),r.cropX=r.oldCropX+r.oldCropW):o.indexOf("right")>-1&&(r.oldCropW+n>=0?(r.cropW=Math.min(this.currentWidth-r.cropX-2*this.padding,r.oldCropW+n),r.cropX=r.oldCropX):(r.cropW=Math.min(Math.abs(n+r.oldCropW),r.oldCropX-2*this.padding),r.cropX=Math.max(this.padding,r.oldCropX-r.cropW))),o.indexOf("top")>-1?r.oldCropH-a>0?(r.cropH=Math.min(r.oldCropH-a,r.oldCropH+r.oldCropY-2*this.padding),r.cropY=Math.max(this.padding,r.oldCropY+a)):(r.cropH=Math.min(a-r.oldCropH,this.currentHeight-r.oldCropY-r.oldCropH),r.cropY=r.oldCropY+r.oldCropH):o.indexOf("bottom")>-1&&(r.oldCropH+a>0?(r.cropH=Math.min(this.currentHeight-r.cropY-2*this.padding,r.oldCropH+a),r.cropY=r.oldCropY):(r.cropH=Math.min(Math.abs(a+r.oldCropH),r.oldCropY-2*this.padding),r.cropY=Math.max(this.padding,r.oldCropY+r.oldCropH+a))),this.target=r,this.clickGeneratePicture()},changeCropEnd:function(){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),this.clickGeneratePicture(),this.$emit("getTargetBox",this.target),this.getTargetImgUrl()},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},changeCropScale:function(t,e){var i=t/e;this.data_list.forEach((function(t){t.cropX=t.cropX*i,t.cropY=t.cropY*i,t.cropW=t.cropW*i,t.cropH=t.cropH*i}))}},watch:{scale:function(t,e){this.url&&(this.currentWidth=this.trueWidth*t/100,this.currentHeight=this.trueHeight*t/100,this.changeCropScale(t,e))}}},o=(i(588),i(73)),n=Object(o.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"cropper-container",style:{width:t.currentWidth+"px",height:t.currentHeight+"px"},on:{mousedown:function(e){return e.preventDefault(),t.startMove.apply(null,arguments)}}},[i("div",{staticClass:"cropper-mask",class:{"bg-opcity":t.list.length>0}}),t._v(" "),i("img",{ref:"sourceImg",style:{width:t.currentWidth+"px",height:t.currentHeight+"px"},attrs:{src:t.url,alt:"背景图片"}}),t._v(" "),t._l(t.data_list,(function(e,r){return i("div",{key:e.id,ref:"imageDom",refInFor:!0,staticClass:"crop-box",style:{width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropX+"px,"+e.cropY+"px,0)"}},[i("span",{staticClass:"cropper-face",on:{mousedown:function(i){return i.stopPropagation(),t.cropMove(i,e)},contextmenu:function(e){return e.preventDefault(),t.deleteCrop(r)}}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.canEdit,expression:"item.canEdit"}]},[t._l(t.lineList,(function(r){return i("span",{key:r,class:["line-"+r,"crop-line"],on:{mousedown:function(i){return i.stopPropagation(),t.changeCropSize(i,e,r)}}})})),t._v(" "),t._l(t.pointList,(function(r){return i("span",{key:r.index,class:["point"+r.index,"crop-point"],on:{mousedown:function(i){return i.stopPropagation(),t.changeCropSize(i,e,r.position)}}})}))],2)])}))],2),t._v(" "),i("div",{staticStyle:{position:"relative"}},[i("canvas",{ref:"previewImg",attrs:{id:"previewImg"}}),t._v(" "),i("button",{staticClass:"download",staticStyle:{position:"absolute"},on:{click:t.download}},[t._v("下载")])])])}),[],!1,null,"7f6dbb70",null);e.default=n.exports}}]);